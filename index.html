<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Costos - Canales Digitales con IA</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" id="favicon" href="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3e%3ccircle cx='50' cy='50' r='40' fill='%23d4af37'/%3e%3ctext x='50' y='60' text-anchor='middle' fill='%23000' font-size='30' font-weight='bold'%3e1%3c/text%3e%3c/svg%3e">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
            color: #2c2c2c;
            line-height: 1.5; /* Ligeramente m√°s compacto */
            min-height: 100vh;
            display: flex; /* Habilitar flexbox para layout de dos columnas */
            overflow: hidden; /* Evitar scroll en el body principal */
        }

        .container {
            display: flex;
            width: 100%;
            max-width: 100%; /* Ajuste para ocupar todo el ancho disponible */
            margin: 0; /* Eliminar margen autom√°tico para ocupar todo el espacio */
            padding: 0; /* Eliminar padding para que el contenido fluya */
        }

        .header {
            text-align: center;
            margin-bottom: 20px; /* Reducido */
            padding: 20px; /* Reducido */
            background: linear-gradient(135deg, #3a3a3a 0%, #2c2c2c 100%);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            color: #d4af37;
            font-size: 2rem; /* Reducido */
            margin-bottom: 5px; /* Reducido */
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            color: #cccccc;
            font-size: 0.9rem; /* Reducido */
            font-weight: 400;
        }

        /* Contenedor principal para el contenido desplazable */
        .main-content {
            flex-grow: 1; /* Ocupar el espacio restante */
            padding: 20px; /* Padding interno para el contenido */
            overflow-y: auto; /* Permitir scroll vertical solo en el contenido principal */
            height: 100vh; /* Ocupar toda la altura de la ventana */
            display: flex;
            flex-direction: column;
            gap: 20px; /* Espacio entre header, modules y navigation-buttons */
        }

        /* Navegaci√≥n y Progreso - Vertical al costado izquierdo */
        .navigation-wrapper {
            background: white;
            border-radius: 12px;
            padding: 15px; /* Ajustar padding */
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
            width: 250px; /* Ancho fijo para la barra lateral */
            min-width: 250px; /* Asegurar que no se haga m√°s peque√±a */
            display: flex;
            flex-direction: row; /* Botones y barra uno al lado del otro */
            justify-content: space-between; /* Espaciar entre botones y barra */
            align-items: stretch; /* Estirar items para llenar el alto disponible */
            height: 100vh; /* Ocupar toda la altura de la ventana */
            overflow-y: hidden; /* Evitar scroll en la barra de navegaci√≥n */
            position: sticky; /* Mantener la barra fija al scrollear el contenido */
            top: 0;
            left: 0;
        }

        .step-buttons-container { /* Nuevo contenedor para los botones de paso */
            display: flex;
            flex-direction: column; /* Apilar botones verticalmente */
            flex-grow: 1; /* Permite que los botones ocupen el espacio disponible */
            gap: 8px; /* Espacio entre botones */
            padding-right: 10px; /* Espacio entre botones y la barra de progreso */
            height: 100%; /* Asegura que ocupe toda la altura disponible */
            justify-content: center; /* Centrar verticalmente los botones si el espacio lo permite */
        }

        .progress-bar {
            background: #e0e0e0;
            width: 8px; /* Ancho para la barra vertical */
            height: 100%; /* Ocupar toda la altura del step-buttons-container */
            border-radius: 4px;
            overflow: hidden;
            position: relative; /* Para posicionar el relleno */
            align-self: center; /* Centrar la barra verticalmente respecto a los botones */
        }

        .progress-fill {
            background: linear-gradient(0deg, #d4af37, #b8941f); /* Gradiente vertical (de abajo hacia arriba) */
            width: 100%; /* Ocupar todo el ancho de la barra vertical */
            height: calc(100% / 7); /* Altura base para el llenado (se ajusta din√°micamente con JS) */
            border-radius: 4px;
            transition: height 0.5s ease; /* Transici√≥n para la altura */
            position: absolute;
            bottom: 0; /* Empieza a llenarse desde abajo */
        }

        .step-navigation {
            /* Este estilo ya no es directamente aplicado a los botones sino al .step-buttons-container */
            /* Se mantiene para referencia, pero su contenido ha sido movido */
            display: none; /* Ocultar el antiguo contenedor de botones de navegaci√≥n */
        }

        .step-button {
            background: #f8f8f8;
            border: 2px solid #e0e0e0;
            padding: 10px 10px; /* Reducido para minimalismo */
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: flex-start; /* Alinear texto a la izquierda */
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 0.9rem; /* Fuente m√°s peque√±a */
            flex-grow: 0; /* No crecer descontroladamente */
            flex-shrink: 0; /* No encogerse */
            white-space: nowrap; /* Evitar que el texto se envuelva */
            width: 100%; /* Ocupar todo el ancho de su contenedor */
            text-align: left; /* Asegurar alineaci√≥n del texto */
        }

        .step-button.active {
            background: linear-gradient(135deg, #d4af37, #b8941f);
            color: white;
            border-color: #d4af37;
        }

        .step-button.completed {
            background: #2c2c2c;
            color: #d4af37;
            border-color: #2c2c2c;
        }

        .step-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .step-icon {
            display: none; /* Ocultar los iconos completamente */
        }

        /* M√≥dulos */
        .module {
            background: white;
            border-radius: 12px;
            padding: 25px; /* Reducido */
            margin-bottom: 15px; /* Reducido */
            box-shadow: 0 8px 32px rgba(0,0,0,0.08);
            border: 1px solid #e0e0e0;
            display: none;
            animation: fadeInUp 0.5s ease;
        }

        .module.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .module-title {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            font-size: 1.6rem; /* Reducido */
            color: #2c2c2c;
            margin-bottom: 15px; /* Reducido */
            padding-bottom: 8px; /* Reducido */
            border-bottom: 3px solid #d4af37;
            display: inline-block;
        }

        .table-container {
            overflow-x: auto;
            margin-bottom: 15px; /* Reducido */
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(0,0,0,0.05);
            font-size: 0.9rem; /* Reducido */
        }

        th {
            background: linear-gradient(135deg, #4a4a4a 0%, #3a3a3a 100%);
            color: #d4af37;
            font-weight: 700;
            padding: 12px; /* Reducido */
            text-align: left;
            font-size: 0.85rem; /* Reducido */
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            padding: 12px; /* Reducido */
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s ease;
        }

        /* QUITADO: Efecto hover en filas de tablas generales */
        /* tr:hover td {
            background-color: #fafafa;
        } */

        tr:last-child td {
            border-bottom: none;
        }

        input[type="checkbox"], input[type="radio"] {
            transform: scale(1.1); /* Ligeramente reducido */
            margin-right: 8px; /* Reducido */
            accent-color: #d4af37;
        }

        input[type="number"], input[type="text"], select {
            padding: 8px; /* Reducido */
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.85rem; /* Reducido */
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            width: 100%;
            max-width: 180px; /* Ligeramente reducido */
        }

        input[type="number"]:focus, input[type="text"]:focus, select:focus {
            border-color: #d4af37;
            outline: none;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        }

        .cost-display {
            font-weight: 700;
            color: #d4af37;
            font-size: 1rem; /* Reducido */
        }

        .input-group {
            display: flex;
            align-items: center;
            gap: 8px; /* Reducido */
            margin-bottom: 12px; /* Reducido */
            flex-wrap: wrap;
        }

        .input-group label {
            font-weight: 600;
            min-width: 180px; /* Ligeramente reducido */
            color: #2c2c2c;
            font-size: 0.9rem; /* Reducido */
        }
        
        .input-group.align-right {
            justify-content: flex-end;
        }

        .gold-accent {
            color: #d4af37;
            font-weight: 700;
        }

        .summary-table {
            background: linear-gradient(135deg, #2c2c2c 0%, #3a3a3a 100%);
            color: white;
            border-radius: 12px;
            overflow: hidden;
        }

        /* QUITADO: Efecto hover en filas de la tabla resumen */
        .summary-table tr:hover td {
            background-color: transparent; /* Eliminar el cambio de color al pasar el cursor */
        }


        .summary-table th {
            background: linear-gradient(135deg, #d4af37 0%, #b8941f 100%);
            color: #2c2c2c;
        }

        .summary-table td {
            border-bottom: 1px solid #4a4a4a;
        }

        .summary-table .total-row {
            background: linear-gradient(135deg, #d4af37 0%, #b8941f 100%);
            color: #2c2c2c;
            font-weight: 700;
            font-size: 1.1rem; /* Mantenido o ligeramente aumentado para subtotales */
        }
        
        /* Ajuste para los valores de subtotal y total en las tablas resumen */
        .summary-table .cost-display {
            color: white; /* Color blanco para contraste */
            font-size: 1.3rem; /* M√°s grande */
            font-weight: 800; /* M√°s audaz */
        }

        .summary-table .total-row .cost-display {
            font-size: 1.5rem; /* A√∫n m√°s grande para el total general */
        }

        .note {
            background: #f0f8ff;
            border: 1px solid #d4af37;
            border-radius: 8px;
            padding: 15px; /* Reducido */
            margin-top: 15px; /* Reducido */
            font-style: italic;
            color: #2c2c2c;
            font-size: 0.85rem; /* Reducido */
        }

        .note ul {
            margin-top: 8px !important; /* Reducido */
            margin-left: 15px !important; /* Reducido */
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px; /* Reducido */
            gap: 10px; /* Reducido */
        }

        .nav-btn {
            background: linear-gradient(135deg, #d4af37, #b8941f);
            color: white;
            border: none;
            padding: 10px 20px; /* Reducido */
            border-radius: 8px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 100px; /* Reducido */
            font-size: 0.9rem; /* Reducido */
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
        }

        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Media Queries para pantallas m√°s peque√±as (m√≥viles) */
        @media (max-width: 992px) { /* Ajustar breakpoint si es necesario */
            body {
                flex-direction: column; /* Volver a apilar verticalmente */
                overflow-y: auto; /* Permitir scroll en el body para m√≥viles */
            }

            .container {
                flex-direction: column;
            }

            .navigation-wrapper {
                width: 100%; /* Ocupar todo el ancho */
                height: auto; /* Altura autom√°tica */
                position: static; /* Eliminar posici√≥n fija */
                padding: 15px 20px; /* Ajustar padding */
                margin-bottom: 20px;
                flex-direction: column; /* Volver a apilar verticalmente */
                justify-content: flex-start; /* Alinear al inicio */
                align-items: center; /* Centrar items */
            }

            .step-buttons-container { /* Vuelve a ser horizontal para los botones */
                flex-direction: row;
                flex-wrap: wrap; /* Permitir que los botones se envuelvan */
                justify-content: space-between;
                padding-right: 0; /* Eliminar padding derecho */
                width: 100%;
                margin-bottom: 15px; /* Espacio entre botones y barra de progreso (ahora debajo) */
                height: auto;
            }

            .progress-bar {
                width: 100%; /* Volver a horizontal */
                height: 8px; /* Altura original */
                margin-top: 10px; /* Espacio arriba de la barra */
                align-self: auto; /* Desactivar align-self */
            }

            .progress-fill {
                height: 100%; /* Volver a horizontal */
                width: calc(100% / 7); /* Ancho original (se ajustar√° con JS) */
                position: static; /* Eliminar posici√≥n absoluta */
                bottom: auto;
            }

            .step-button {
                min-width: auto;
                justify-content: center;
                font-size: 0.95rem;
                padding: 12px 20px;
                flex-grow: 1; /* Para que se distribuyan equitativamente */
            }

            .main-content {
                padding: 0 20px; /* Ajustar padding para m√≥viles */
                height: auto; /* Altura autom√°tica */
            }
            
            .header h1 {
                font-size: 2.2rem; 
            }
            
            .module {
                padding: 20px;
            }
            
            .input-group {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .input-group label {
                min-width: auto;
            }
            
            input[type="number"], input[type="text"], select {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="navigation-wrapper">
            <div class="step-buttons-container">
                <button class="step-button active" onclick="goToStep(0)">
                    <span>1. Canales</span>
                </button>
                <button class="step-button" onclick="goToStep(1)">
                    <span>2. Conversaciones</span>
                </button>
                <button class="step-button" onclick="goToStep(2)">
                    <span>3. MindX Insights</span>
                </button>
                <button class="step-button" onclick="goToStep(3)">
                    <span>4. Agentes MindX</span>
                </button>
                <button class="step-button" onclick="goToStep(4)">
                    <span>5. IA Generativa</span>
                </button>
                 <button class="step-button" onclick="goToStep(5)">
                    <span>6. Notificaciones</span>
                </button>
                <button class="step-button" onclick="goToStep(6)">
                    <span>7. Resumen</span>
                </button>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

        <div class="main-content">
            <div class="header">
                <h1>Calculadora de Costos</h1>
                <p>Canales Digitales con Inteligencia Artificial</p>
            </div>

            <div class="module active" id="module0">
                <h2 class="module-title">1. Selecci√≥n de Canales Digitales</h2>
                <p style="margin-bottom: 20px; color: #666;">El primer canal seleccionado es <span class="gold-accent">gratuito</span>. Canales adicionales tienen un costo <strong>mensual recurrente</strong> de <span class="gold-accent">USD $100</span> cada uno.</p>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Seleccionar</th>
                                <th>Canal</th>
                                <th>Costo Mensual (USD)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input type="checkbox" id="whatsapp" onchange="calculateChannelCosts()"></td>
                                <td>WhatsApp</td>
                                <td class="cost-display">$0.00 (Primer canal gratuito)</td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" id="telegram" onchange="calculateChannelCosts()"></td>
                                <td>Telegram</td>
                                <td class="cost-display">$100.00</td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" id="facebook" onchange="calculateChannelCosts()"></td>
                                <td>Facebook Messenger</td>
                                <td class="cost-display">$100.00</td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" id="instagram" onchange="calculateChannelCosts()"></td>
                                <td>Instagram Direct Message</td>
                                <td class="cost-display">$100.00</td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" id="webchat" onchange="calculateChannelCosts()"></td>
                                <td>WebChat (Widget o Embebido)</td>
                                <td class="cost-display">$100.00</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="text-align: right; margin-top: 15px;">
                    <strong>Subtotal Canales (Mensual): <span class="gold-accent" id="channelSubtotal">$0.00 USD</span></strong>
                </div>
            </div>

            <div class="module" id="module1">
                <h2 class="module-title">2. Paquetes de Conversaciones</h2>
                <p style="margin-bottom: 20px; color: #666;">Seleccione el paquete de conversaciones que mejor se adapte a sus necesidades. <strong>Incluye licencias de MindX Insights.</strong></p>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Seleccionar</th>
                                <th>Paquete</th>
                                <th>Conversaciones Incluidas</th>
                                <th>Licencias MindX Insights</th>
                                <th>Precio (USD)</th>
                                <th>Valor Conv. Adicional (USD)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input type="radio" name="package" value="3500-283-1-0.075-B√°sico" onchange="calculatePackageCosts()"></td>
                                <td>B√°sico</td>
                                <td>3,500</td>
                                <td class="gold-accent">1 licencia</td>
                                <td class="cost-display">$283.00</td>
                                <td class="cost-display">$0.075</td>
                            </tr>
                            <tr>
                                <td><input type="radio" name="package" value="5500-343-1-0.059-Est√°ndar" onchange="calculatePackageCosts()"></td>
                                <td>Est√°ndar</td>
                                <td>5,500</td>
                                <td class="gold-accent">1 licencia</td>
                                <td class="cost-display">$343.00</td>
                                <td class="cost-display">$0.059</td>
                            </tr>
                            <tr>
                                <td><input type="radio" name="package" value="8500-453-2-0.049-Profesional" onchange="calculatePackageCosts()"></td>
                                <td>Profesional</td>
                                <td>8,500</td>
                                <td class="gold-accent">2 licencias</td>
                                <td class="cost-display">$453.00</td>
                                <td class="cost-display">$0.049</td>
                            </tr>
                            <tr>
                                <td><input type="radio" name="package" value="10000-510-2-0.047-Empresarial" onchange="calculatePackageCosts()"></td>
                                <td>Empresarial</td>
                                <td>10,000</td>
                                <td class="gold-accent">2 licencias</td>
                                <td class="cost-display">$510.00</td>
                                <td class="cost-display">$0.047</td>
                            </tr>
                            <tr>
                                <td><input type="radio" name="package" value="30000-1428-2-0.046-Corporativo I" onchange="calculatePackageCosts()"></td>
                                <td>Corporativo I</td>
                                <td>30,000</td>
                                <td class="gold-accent">2 licencias</td>
                                <td class="cost-display">$1,428.00</td>
                                <td class="cost-display">$0.046</td>
                            </tr>
                            <tr>
                                <td><input type="radio" name="package" value="60000-2747-2-0.045-Corporativo II" onchange="calculatePackageCosts()"></td>
                                <td>Corporativo II</td>
                                <td>60,000</td>
                                <td class="gold-accent">2 licencias</td>
                                <td class="cost-display">$2,747.00</td>
                                <td class="cost-display">$0.045</td>
                            </tr>
                            <tr>
                                <td><input type="radio" name="package" value="90000-3996-2-0.044-Corporativo III" onchange="calculatePackageCosts()"></td>
                                <td>Corporativo III</td>
                                <td>90,000</td>
                                <td class="gold-accent">2 licencias</td>
                                <td class="cost-display">$3,996.00</td>
                                <td class="cost-display">$0.044</td>
                            </tr>
                            <tr>
                                <td><input type="radio" name="package" value="120000-5176-2-0.043-Enterprise I" onchange="calculatePackageCosts()"></td>
                                <td>Enterprise I</td>
                                <td>120,000</td>
                                <td class="gold-accent">2 licencias</td>
                                <td class="cost-display">$5,176.00</td>
                                <td class="cost-display">$0.043</td>
                            </tr>
                            <tr>
                                <td><input type="radio" name="package" value="150000-6287-2-0.042-Enterprise II" onchange="calculatePackageCosts()"></td>
                                <td>Enterprise II</td>
                                <td>150,000</td>
                                <td class="gold-accent">2 licencias</td>
                                <td class="cost-display">$6,287.00</td>
                                <td class="cost-display">$0.042</td>
                            </tr>
                            </tbody>
                    </table>
                </div>
                
                <div class="input-group" style="margin-top: 15px;">
                    <label>Conversaciones Adicionales (fuera de paquete):</label>
                    <input type="number" id="additionalConversations" min="0" value="0" onchange="calculatePackageCosts()">
                </div>

                <div style="text-align: right; margin-top: 15px;">
                    <strong>Subtotal Conversaciones (Mensual): <span class="gold-accent" id="packageSubtotal">$0.00 USD</span></strong>
                </div>
            </div>

            <div class="module" id="module2">
                <h2 class="module-title">3. Licencias Adicionales MindX Insights</h2>
                <p style="margin-bottom: 20px; color: #666;">Su paquete incluye <span class="gold-accent" id="includedLicenses">0</span> licencias de MindX Insights. Puede agregar licencias adicionales por <span class="gold-accent">USD $20</span> cada una (mensual).</p>
                
                <div class="input-group">
                    <label>Licencias adicionales de MindX Insights:</label>
                    <input type="number" id="additionalInsights" min="0" value="0" onchange="calculateInsightsCosts()">
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Concepto</th>
                                <th>Cantidad</th>
                                <th>Precio Unitario</th>
                                <th>Subtotal (USD)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Licencias incluidas en paquete</td>
                                <td class="gold-accent" id="packageLicensesDisplay">0</td>
                                <td>Incluido</td>
                                <td class="cost-display">$0.00</td>
                            </tr>
                            <tr>
                                <td>Licencias adicionales</td>
                                <td class="gold-accent" id="additionalLicensesDisplay">0</td>
                                <td>$20.00</td> <td class="cost-display" id="additionalInsightsCost">$0.00</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div style="text-align: right; margin-top: 15px;">
                    <strong>Subtotal MindX Insights (Mensual): <span class="gold-accent" id="insightsSubtotal">$0.00 USD</span></strong>
                </div>
            </div>

            <div class="module" id="module3">
                <h2 class="module-title">4. Licencias de Agentes MindX</h2>
                <p style="margin-bottom: 20px; color: #666;">Licencias de agentes para gesti√≥n avanzada. Cada licencia tiene un costo de <span class="gold-accent">$20 USD</span> mensual.</p>
                
                <div class="input-group">
                    <label>Cantidad de licencias de Agentes MindX:</label>
                    <input type="number" id="agentLicenses" min="0" value="0" onchange="calculateAgentCosts()">
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Concepto</th>
                                <th>Cantidad</th>
                                <th>Precio Unitario</th>
                                <th>Subtotal (USD)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Licencias de Agentes MindX</td>
                                <td class="gold-accent" id="agentLicensesDisplay">0</td>
                                <td>$20.00</td>
                                <td class="cost-display" id="agentsCost">$0.00</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div style="text-align: right; margin-top: 15px;">
                    <strong>Subtotal Agentes MindX (Mensual): <span class="gold-accent" id="agentsSubtotal">$0.00 USD</span></strong>
                </div>
            </div>

            <div class="module" id="module4">
                <h2 class="module-title">5. Inteligencia Artificial Generativa</h2>
                
                <div class="input-group">
                    <label>
                        <input type="checkbox" id="includeAI" onchange="toggleAISection()">
                        ¬øDesea incluir IA Generativa en su soluci√≥n?
                    </label>
                </div>

                <div id="aiDetails" style="display: none;">
                    <h3 style="margin-top: 20px; margin-bottom: 15px; color: #2c2c2c;">Configuraci√≥n de Consumo</h3>
                    <div class="input-group">
                        <label>Mensajes promedio por conversaci√≥n:</label>
                        <input type="number" id="messagesPerConversation" min="1" value="10" onchange="calculateAICosts()">
                    </div>

                    <div class="input-group">
                        <label>Mensajes que requerir√°n IA Generativa:</label>
                        <input type="number" id="aiMessages" min="0" value="5" onchange="calculateAICosts()">
                    </div>

                    <div class="input-group">
                        <label>Tama√±o del archivo de conocimiento (MB):</label>
                        <input type="number" id="fileSize" min="0.1" step="0.1" value="10" onchange="calculateAICosts()">
                    </div>

                    <div class="input-group">
                        <label>Frecuencia de actualizaci√≥n del archivo:</label>
                        <select id="updateFrequency" onchange="calculateAICosts()">
                            <option value="1">Mensual</option>
                            <option value="3">Trimestral</option>
                            <option value="6">Semestral</option>
                            <option value="12">Anual</option>
                        </select>
                    </div>

                    <h3 style="margin-top: 20px; margin-bottom: 15px; color: #2c2c2c;">Seleccione el Modelo de Costo de IA:</h3>
                    <div class="input-group">
                        <label>
                            <input type="radio" name="aiModelOption" value="tokens" checked onchange="calculateAICosts()">
                            Opci√≥n 1: Modelo por Tokens
                        </label>
                        <label>
                            <input type="radio" name="aiModelOption" value="messages" onchange="calculateAICosts()">
                            Opci√≥n 2: Modelo por Mensajes
                        </label>
                    </div>


                    <div id="aiTokenModelTable" class="table-container" style="margin-top: 20px;">
                        <h4>Opci√≥n 1: Modelo por Tokens</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Componente IA</th>
                                    <th>Descripci√≥n</th>
                                    <th>Tipo de Costo</th>
                                    <th>Valor (USD)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Carga de Informaci√≥n</td>
                                    <td>$0.093 por MB √ó frecuencia anual</td>
                                    <td>Anual</td>
                                    <td class="cost-display" id="loadingCostTokens">$0.00</td>
                                </tr>
                                <tr>
                                    <td>Almacenamiento</td>
                                    <td>Archivo √ó $1.7 (por MB)</td>
                                    <td>Mensual</td>
                                    <td class="cost-display" id="storageCostTokens">$0.00</td>
                                </tr>
                                <tr>
                                    <td>Consumo de Tokens</td>
                                    <td>$6.3 por mill√≥n de tokens</td>
                                    <td>Mensual</td>
                                    <td class="cost-display" id="tokenCostTokens">$0.00</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div id="aiMessageModelTable" class="table-container" style="margin-top: 20px; display: none;">
                        <h4>Opci√≥n 2: Modelo por Mensajes</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Componente IA</th>
                                    <th>Descripci√≥n</th>
                                    <th>Tipo de Costo</th>
                                    <th>Valor (USD)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Carga de Informaci√≥n</td>
                                    <td>$0.093 por MB √ó frecuencia anual</td>
                                    <td>Anual</td>
                                    <td class="cost-display" id="loadingCostMessages">$0.00</td>
                                </tr>
                                <tr>
                                    <td>Almacenamiento</td>
                                    <td>Archivo √ó $1.7 (por MB)</td>
                                    <td>Mensual</td>
                                    <td class="cost-display" id="storageCostMessages">$0.00</td>
                                </tr>
                                <tr>
                                    <td>Modelo de Mensajes</td>
                                    <td>$111 por cada 20,000 mensajes</td>
                                    <td>Mensual</td>
                                    <td class="cost-display" id="messageCostMessages">$0.00</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div style="text-align: right; margin-top: 15px;">
                        <div><strong>Subtotal IA Carga (Anual): <span class="gold-accent" id="aiLoadingSubtotal">$0.00 USD</span></strong></div>
                        <div><strong>Subtotal IA Operaci√≥n (Mensual): <span class="gold-accent" id="aiMonthlySubtotal">$0.00 USD</span></strong></div>
                    </div>
                </div>
            </div>

            <div class="module" id="module5">
                <h2 class="module-title">6. Notificaciones Outbound de WhatsApp</h2>
                <p style="margin-bottom: 20px; color: #666;">Ingrese la cantidad estimada de mensajes salientes (plantillas) por mes para cada categor√≠a.</p>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Tipo de Plantilla</th>
                                <th>Valor por Notificaci√≥n Adicional (USD)</th>
                                <th>Cantidad Mensual Estimada</th>
                                <th>Costo Mensual (USD)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Marketing (out)</td>
                                <td>$0.0150</td>
                                <td><input type="number" id="notifMarketingQty" min="0" value="0" onchange="calculateNotificationCosts()"></td>
                                <td class="cost-display" id="notifMarketingCost">$0.00</td>
                            </tr>
                            <tr>
                                <td>Utility (out)</td>
                                <td>$0.0024</td>
                                <td><input type="number" id="notifUtilityQty" min="0" value="0" onchange="calculateNotificationCosts()"></td>
                                <td class="cost-display" id="notifUtilityCost">$0.00</td>
                            </tr>
                            <tr>
                                <td>Authentication (out)</td>
                                <td>$0.0092</td>
                                <td><input type="number" id="notifAuthenticationQty" min="0" value="0" onchange="calculateNotificationCosts()"></td>
                                <td class="cost-display" id="notifAuthenticationCost">$0.00</td>
                            </tr>
                            <tr>
                                <td>Services (in) <span style="font-style: italic; color: #888;">(Entrante, sin costo)</span></td>
                                <td>-</td>
                                <td><input type="number" id="notifServicesInQty" min="0" value="0" onchange="calculateNotificationCosts()"></td>
                                <td class="cost-display">$0.00</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="text-align: right; margin-top: 15px;">
                    <strong>Subtotal Notificaciones (Mensual): <span class="gold-accent" id="notificationSubtotal">$0.00 USD</span></strong>
                </div>
            </div>

            <div class="module" id="module6">
                <h2 class="module-title">Resumen de Costos</h2>
                
                <div class="table-container">
                    <table class="summary-table">
                        <thead>
                            <tr>
                                <th>Concepto</th>
                                <th>Cantidad</th>
                                <th>Costo Mensual (USD)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td id="summaryChannelsConcept">Canales Digitales</td>
                                <td class="gold-accent" id="summaryChannelsQty">0</td>
                                <td class="cost-display" id="summaryChannelsMonthly">$0.00</td>
                            </tr>
                            <tr>
                                <td id="summaryPackageConcept">Paquete de Conversaciones</td>
                                <td class="gold-accent" id="summaryPackageQty">0</td>
                                <td class="cost-display" id="summaryPackageMonthly">$0.00</td>
                            </tr>
                            <tr>
                                <td>MindX Insights Adicionales</td>
                                <td class="gold-accent" id="summaryInsightsQty">0</td>
                                <td class="cost-display" id="summaryInsightsMonthly">$0.00</td>
                            </tr>
                            <tr>
                                <td>Agentes MindX</td>
                                <td class="gold-accent" id="summaryAgentsQty">0</td>
                                <td class="cost-display" id="summaryAgentsMonthly">$0.00</td>
                            </tr>
                            <tr>
                                <td>IA - Operaci√≥n Mensual</td>
                                <td class="gold-accent" id="summaryAIOperationQty">0</td>
                                <td class="cost-display" id="summaryAIMonthly">$0.00</td>
                            </tr>
                            <tr>
                                <td id="summaryNotificationsConcept">Notificaciones Outbound WhatsApp</td>
                                <td class="gold-accent" id="summaryNotificationsQty">0</td>
                                <td class="cost-display" id="summaryNotificationsMonthly">$0.00</td>
                            </tr>
                            <tr class="total-row">
                                <td><strong>SUBTOTAL MENSUAL RECURRENTE</strong></td>
                                <td><strong>-</strong></td>
                                <td class="cost-display"><strong id="totalMonthlyRecurrent">$0.00</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div style="margin-top: 30px;">
                    <h3 style="color: #2c2c2c; margin-bottom: 20px; font-weight: 700;">Resumen Total de Inversi√≥n</h3>
                    
                    <div class="input-group" style="margin-bottom: 20px;">
                        <label>TRM (Tasa Representativa del Mercado):</label>
                        <input type="number" id="trm" min="0" step="0.01" value="4200" oninput="calculateCurrencyConversion()" placeholder="Ej: 4200">
                        <span style="color: #666; margin-left: 10px;">COP por USD</span>
                    </div>

                    <div class="table-container">
                        <table class="summary-table">
                            <thead>
                                <tr>
                                    <th>Concepto</th>
                                    <th>Valor USD</th>
                                    <th>Valor COP</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>IA - Carga Inicial (Anual)</td>
                                    <td class="cost-display" id="totalAILoadingUSD">$0.00</td>
                                    <td class="cost-display" id="totalAILoadingCOP">$0</td>
                                </tr>
                                <tr>
                                    <td>Total Mensual Recurrente</td>
                                    <td class="cost-display" id="totalMonthlyUSD">$0.00</td>
                                    <td class="cost-display" id="totalMonthlyCOP">$0</td>
                                </tr>
                                <tr class="total-row">
                                    <td><strong>Total Anual (12 meses de recurrente + carga IA)</strong></td>
                                    <td class="cost-display"><strong id="totalAnnualUSD">$0.00</strong></td>
                                    <td class="cost-display"><strong id="totalAnnualCOP">$0</strong></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="note">
                    <p><strong>üìã Notas Importantes:</strong></p>
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li>Los servicios est√°n excluidos de IVA por ser servicios en la nube</li>
                        <li>Se incluye soporte local 24/7 que cubre incidencias y ca√≠das totales del servicio</li>
                        <li>Los costos de IA Generativa var√≠an seg√∫n el uso real del sistema</li>
                        <li>Los paquetes personalizados requieren validaci√≥n con el Arquitecto de Diferenciaci√≥n</li>
                        <li>Los costos de carga de IA se calculan anualmente seg√∫n la frecuencia de actualizaci√≥n (mensual x12, trimestral x4, semestral x2, anual x1)</li>
                        <li>La TRM es solo para referencia, verificar tasa actual al momento de la facturaci√≥n</li>
                        <li>El total anual incluye 12 meses de servicios recurrentes m√°s el costo de carga inicial de IA</li>
                    </ul>
                </div>
            </div>

            <div class="navigation-buttons">
                <button class="nav-btn" id="prevBtn" onclick="previousStep()" disabled>‚¨Ö Anterior</button>
                <button class="nav-btn" id="nextBtn" onclick="nextStep()">Siguiente ‚û°</button>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 0;
        const TOTAL_MODULES = 7; 

        let channelCost = 0;
        let channelsSelected = 0;
        let selectedChannelNames = []; 
        let packageCost = 0;
        let packageConversations = 0;
        let packageLicenses = 0;
        let selectedPackageName = ''; 
        let additionalConversationCostPerUnit = 0; // Costo por conversaci√≥n adicional fuera del paquete
        let additionalConversationsQty = 0; // Cantidad de conversaciones adicionales
        
        let additionalInsightsCost = 0;
        let additionalInsightsQty = 0;
        const INSIGHTS_LICENSE_COST = 20; // COSTO ACTUALIZADO AQU√ç
        
        let agentsCost = 0;
        let agentsQty = 0;
        let aiLoadingCost = 0;
        let aiMonthlyCost = 0;
        let aiDetailsIncluded = false;
        let aiModelSelected = 'tokens'; 
        let notificationCost = 0; 
        let totalNotificationsQty = 0; 

        const TRM_DEFAULT = 4200; 

        const NOTIFICATION_PRICES = {
            marketing: 0.0150,
            utility: 0.0024,
            authentication: 0.0092
        };

        function updateFavicon(step) {
            const favicon = document.getElementById('favicon');
            const stepNumber = step + 1;
            favicon.href = `data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3e%3ccircle cx='50' cy='50' r='40' fill='%23d4af37'/%3e%3ctext x='50' y='60' text-anchor='middle' fill='%23000' font-size='30' font-weight='bold'%3e${stepNumber}%3c/text%3e%3c/svg%3e`;
        }

        function goToStep(step) {
            if (step < 0 || step >= TOTAL_MODULES) return;

            document.getElementById(`module${currentStep}`).classList.remove('active');
            document.getElementById(`module${step}`).classList.add('active');
            
            const buttons = document.querySelectorAll('.step-buttons-container .step-button'); // Apunta al nuevo contenedor
            buttons.forEach((btn, index) => {
                btn.classList.remove('active');
                if (index < step) {
                    btn.classList.add('completed');
                } else {
                    btn.classList.remove('completed');
                }
            });
            buttons[step].classList.add('active');
            
            const progressFill = document.getElementById('progressFill');
            // Calcula el porcentaje de altura del progreso basado en el n√∫mero de pasos
            const progressHeight = ((step + 1) / TOTAL_MODULES) * 100; 
            progressFill.style.height = `${progressHeight}%`;
            
            updateFavicon(step);
            
            document.getElementById('prevBtn').disabled = step === 0;
            document.getElementById('nextBtn').textContent = step === (TOTAL_MODULES - 1) ? 'Finalizar' : 'Siguiente ‚û°';
            
            currentStep = step;

            if (currentStep === (TOTAL_MODULES - 1)) {
                updateSummary();
                calculateCurrencyConversion();
            }
        }

        function nextStep() {
            if (currentStep < (TOTAL_MODULES - 1)) {
                goToStep(currentStep + 1);
            }
        }

        function previousStep() {
            if (currentStep > 0) {
                goToStep(currentStep - 1);
            }
        }

        function calculateChannelCosts() {
            const channels = ['whatsapp', 'telegram', 'facebook', 'instagram', 'webchat']; 
            selectedChannelNames = []; 
            let selectedCount = 0;
            
            channels.forEach(channel => {
                const checkbox = document.getElementById(channel);
                if (checkbox.checked) {
                    selectedCount++;
                    selectedChannelNames.push(checkbox.parentNode.nextElementSibling.textContent); 
                }
            });

            channelsSelected = selectedCount;
            channelCost = selectedCount > 0 ? (selectedCount - 1) * 100 : 0;
            
            const rows = document.querySelectorAll('#module0 table tbody tr');
            
            rows.forEach(row => {
                const channelId = row.querySelector('input[type="checkbox"]').id;
                const costCell = row.querySelector('.cost-display');
                if (channelId === 'whatsapp') {
                    costCell.textContent = '$0.00 (Primer canal gratuito)';
                } else {
                    costCell.textContent = '$100.00';
                }
            });

            if (selectedCount === 1) {
                const firstSelectedCheckbox = document.querySelector('#module0 input[type="checkbox"]:checked');
                if (firstSelectedCheckbox) {
                    firstSelectedCheckbox.parentNode.nextElementSibling.nextElementSibling.textContent = '$0.00 (Primer canal gratuito)';
                }
            }

            document.getElementById('channelSubtotal').textContent = `$${channelCost.toFixed(2)} USD`;
            updateSummary();
        }

        function calculatePackageCosts() {
            const selectedPackageRadio = document.querySelector('input[name="package"]:checked');
            
            additionalConversationsQty = parseInt(document.getElementById('additionalConversations').value) || 0; 

            if (selectedPackageRadio) {
                // Formato de value: "conversaciones-costoBase-licencias-costoAdicionalPorConv-nombre"
                const packageData = selectedPackageRadio.value.split('-');
                packageConversations = parseInt(packageData[0]);
                packageCost = parseFloat(packageData[1]); // Este es el "Valor USD"
                packageLicenses = parseInt(packageData[2]);
                additionalConversationCostPerUnit = parseFloat(packageData[3]); // "Valor Conversaci√≥n Adicional"
                selectedPackageName = packageData[4]; 
                
                // Calcular el costo total del paquete, incluyendo conversaciones adicionales si las hay
                const totalPackageCost = packageCost + (additionalConversationsQty * additionalConversationCostPerUnit);
                packageCost = totalPackageCost; // Actualizar el costo del paquete para el resumen

                document.getElementById('packageSubtotal').textContent = `$${packageCost.toFixed(2)} USD`;
                document.getElementById('includedLicenses').textContent = packageLicenses;
                document.getElementById('packageLicensesDisplay').textContent = packageLicenses;
                
                calculateInsightsCosts();
                calculateAICosts();
            } else {
                packageCost = 0;
                packageConversations = 0;
                packageLicenses = 0;
                additionalConversationCostPerUnit = 0;
                selectedPackageName = ''; 
                document.getElementById('packageSubtotal').textContent = '$0.00 USD';
                document.getElementById('includedLicenses').textContent = '0';
                document.getElementById('packageLicensesDisplay').textContent = '0';
                calculateInsightsCosts();
                calculateAICosts();
            }
            
            updateSummary();
        }

        function calculateInsightsCosts() {
            additionalInsightsQty = parseInt(document.getElementById('additionalInsights').value) || 0;
            additionalInsightsCost = additionalInsightsQty * INSIGHTS_LICENSE_COST; // USAR LA CONSTANTE
            
            document.getElementById('additionalLicensesDisplay').textContent = additionalInsightsQty;
            document.getElementById('additionalInsightsCost').textContent = `$${additionalInsightsCost.toFixed(2)}`;
            document.getElementById('insightsSubtotal').textContent = `$${additionalInsightsCost.toFixed(2)} USD`;
            
            updateSummary();
        }

        function calculateAgentCosts() {
            agentsQty = parseInt(document.getElementById('agentLicenses').value) || 0;
            agentsCost = agentsQty * 20;
            
            document.getElementById('agentLicensesDisplay').textContent = agentsQty;
            document.getElementById('agentsCost').textContent = `$${agentsCost.toFixed(2)}`;
            document.getElementById('agentsSubtotal').textContent = `$${agentsCost.toFixed(2)} USD`;
            
            updateSummary();
        }

        function toggleAISection() {
            aiDetailsIncluded = document.getElementById('includeAI').checked;
            const aiDetails = document.getElementById('aiDetails');
            
            if (aiDetailsIncluded) {
                aiDetails.style.display = 'block';
                const selectedAIMethod = document.querySelector('input[name="aiModelOption"]:checked').value;
                document.getElementById('aiTokenModelTable').style.display = (selectedAIMethod === 'tokens' ? 'block' : 'none');
                document.getElementById('aiMessageModelTable').style.display = (selectedAIMethod === 'messages' ? 'block' : 'none');
                calculateAICosts();
            } else {
                aiDetails.style.display = 'none';
                aiLoadingCost = 0;
                aiMonthlyCost = 0;
                updateAIDisplay();
                updateSummary();
            }
        }

        function calculateAICosts() {
            if (!aiDetailsIncluded || packageConversations === 0) {
                aiLoadingCost = 0;
                aiMonthlyCost = 0;
                updateAIDisplay();
                updateSummary();
                return;
            }

            const messagesPerConversation = parseInt(document.getElementById('messagesPerConversation').value) || 0;
            const aiMessages = parseInt(document.getElementById('aiMessages').value) || 0;
            const fileSize = parseFloat(document.getElementById('fileSize').value) || 0;
            const updateFrequency = parseInt(document.getElementById('updateFrequency').value) || 12;
            
            aiModelSelected = document.querySelector('input[name="aiModelOption"]:checked').value;

            document.getElementById('aiTokenModelTable').style.display = (aiModelSelected === 'tokens' ? 'block' : 'none');
            document.getElementById('aiMessageModelTable').style.display = (aiModelSelected === 'messages' ? 'block' : 'none');

            const loadingCostPerUpdate = fileSize * 0.093;
            let updatesPerYear;
            switch(updateFrequency) {
                case 1: updatesPerYear = 12; break;
                case 3: updatesPerYear = 4; break;
                case 6: updatesPerYear = 2; break;
                case 12: updatesPerYear = 1; break;
                default: updatesPerYear = 1;
            }
            aiLoadingCost = loadingCostPerUpdate * updatesPerYear;

            const storageCost = fileSize * 1.7;

            let tokenCostMonthly = 0;
            let messageCostMonthly = 0;

            if (aiModelSelected === 'tokens') {
                const totalConversationsMonthly = packageConversations;
                const totalAIMessagesMonthly = totalConversationsMonthly * aiMessages;
                const totalTokensMonthly = totalAIMessagesMonthly * 880; 
                tokenCostMonthly = (totalTokensMonthly / 1000000) * 6.3; // Costo por mill√≥n de tokens para IA
                if (tokenCostMonthly < 0.01) tokenCostMonthly = 0;

                messageCostMonthly = 0; 
            } else if (aiModelSelected === 'messages') {
                const totalConversationsMonthly = packageConversations;
                const totalMessagesMonthly = totalConversationsMonthly * messagesPerConversation;
                messageCostMonthly = (totalMessagesMonthly / 20000) * 111;

                tokenCostMonthly = 0; 
            }
            
            aiMonthlyCost = storageCost + tokenCostMonthly + messageCostMonthly;

            document.getElementById('loadingCostTokens').textContent = `$${loadingCostPerUpdate.toFixed(2)} (x${updatesPerYear}/a√±o = $${aiLoadingCost.toFixed(2)})`;
            document.getElementById('storageCostTokens').textContent = `$${storageCost.toFixed(2)}`;
            document.getElementById('tokenCostTokens').textContent = `$${aiModelSelected === 'tokens' ? tokenCostMonthly.toFixed(2) : '0.00'}`;

            document.getElementById('loadingCostMessages').textContent = `$${loadingCostPerUpdate.toFixed(2)} (x${updatesPerYear}/a√±o = $${aiLoadingCost.toFixed(2)})`;
            document.getElementById('storageCostMessages').textContent = `$${storageCost.toFixed(2)}`;
            document.getElementById('messageCostMessages').textContent = `$${aiModelSelected === 'messages' ? messageCostMonthly.toFixed(2) : '0.00'}`;

            updateAIDisplay();
            updateSummary();
        }

        function updateAIDisplay() {
            document.getElementById('aiLoadingSubtotal').textContent = `$${aiLoadingCost.toFixed(2)} USD`;
            document.getElementById('aiMonthlySubtotal').textContent = `$${aiMonthlyCost.toFixed(2)} USD`;
        }

        function calculateNotificationCosts() {
            const marketingQty = parseInt(document.getElementById('notifMarketingQty').value) || 0;
            const utilityQty = parseInt(document.getElementById('notifUtilityQty').value) || 0;
            const authenticationQty = parseInt(document.getElementById('notifAuthenticationQty').value) || 0;
            const servicesInQty = parseInt(document.getElementById('notifServicesInQty').value) || 0; 

            const marketingCost = marketingQty * NOTIFICATION_PRICES.marketing;
            const utilityCost = utilityQty * NOTIFICATION_PRICES.utility;
            const authenticationCost = authenticationQty * NOTIFICATION_PRICES.authentication;

            notificationCost = marketingCost + utilityCost + authenticationCost;
            totalNotificationsQty = marketingQty + utilityQty + authenticationQty + servicesInQty; 

            document.getElementById('notifMarketingCost').textContent = `$${marketingCost.toFixed(2)}`;
            document.getElementById('notifUtilityCost').textContent = `$${utilityCost.toFixed(2)}`;
            document.getElementById('notifAuthenticationCost').textContent = `$${authenticationCost.toFixed(2)}`;
            document.getElementById('notificationSubtotal').textContent = `$${notificationCost.toFixed(2)} USD`;

            updateSummary();
        }

        function updateSummary() {
            let channelsConceptText = "Canales Digitales";
            if (selectedChannelNames.length > 0) {
                channelsConceptText += ` (${selectedChannelNames.join(', ')})`;
            }
            document.getElementById('summaryChannelsConcept').textContent = channelsConceptText;
            document.getElementById('summaryChannelsQty').textContent = channelsSelected;

            let packageConceptText = "Paquete de Conversaciones";
            if (selectedPackageName) {
                packageConceptText += ` (${selectedPackageName})`;
                document.getElementById('summaryPackageQty').textContent = `${packageConversations.toLocaleString()} convers. ${additionalConversationsQty > 0 ? `+ ${additionalConversationsQty.toLocaleString()} adic.` : ''}`;
            } else {
                document.getElementById('summaryPackageQty').textContent = '0';
            }
            document.getElementById('summaryPackageConcept').textContent = packageConceptText;
            
            document.getElementById('summaryInsightsQty').textContent = additionalInsightsQty;
            document.getElementById('summaryAgentsQty').textContent = agentsQty;
            document.getElementById('summaryAIOperationQty').textContent = aiDetailsIncluded && packageConversations > 0 ? (aiModelSelected === 'tokens' ? 'Modelo por Tokens' : 'Modelo por Mensajes') : 'No incluido';

            document.getElementById('summaryNotificationsConcept').textContent = 'Notificaciones Outbound WhatsApp';
            document.getElementById('summaryNotificationsQty').textContent = totalNotificationsQty.toLocaleString();
            document.getElementById('summaryNotificationsMonthly').textContent = `$${notificationCost.toFixed(2)}`;

            document.getElementById('summaryChannelsMonthly').textContent = `$${channelCost.toFixed(2)}`;
            document.getElementById('summaryPackageMonthly').textContent = `$${packageCost.toFixed(2)}`;
            document.getElementById('summaryInsightsMonthly').textContent = `$${additionalInsightsCost.toFixed(2)}`;
            document.getElementById('summaryAgentsMonthly').textContent = `$${agentsCost.toFixed(2)}`;
            document.getElementById('summaryAIMonthly').textContent = `$${aiMonthlyCost.toFixed(2)}`;

            const totalMonthlyRecurrent = channelCost + packageCost + additionalInsightsCost + agentsCost + aiMonthlyCost + notificationCost;
            document.getElementById('totalMonthlyRecurrent').textContent = `$${totalMonthlyRecurrent.toFixed(2)}`;

            document.getElementById('totalAILoadingUSD').textContent = `$${aiLoadingCost.toFixed(2)}`;
            document.getElementById('totalMonthlyUSD').textContent = `$${totalMonthlyRecurrent.toFixed(2)}`;
            
            const totalAnnualUSD = (totalMonthlyRecurrent * 12) + aiLoadingCost;
            document.getElementById('totalAnnualUSD').textContent = `$${totalAnnualUSD.toFixed(2)}`;

            calculateCurrencyConversion();
        }

        function calculateCurrencyConversion() {
            const trmInput = document.getElementById('trm');
            const trm = parseFloat(trmInput.value) || 0;

            const totalAILoadingUSD = parseFloat(document.getElementById('totalAILoadingUSD').textContent.replace('$', '')) || 0;
            const totalMonthlyUSD = parseFloat(document.getElementById('totalMonthlyUSD').textContent.replace('$', '')) || 0;
            const totalAnnualUSD = parseFloat(document.getElementById('totalAnnualUSD').textContent.replace('$', '')) || 0;

            document.getElementById('totalAILoadingCOP').textContent = `$${(totalAILoadingUSD * trm).toLocaleString('es-CO', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
            document.getElementById('totalMonthlyCOP').textContent = `$${(totalMonthlyUSD * trm).toLocaleString('es-CO', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
            document.getElementById('totalAnnualCOP').textContent = `$${(totalAnnualUSD * trm).toLocaleString('es-CO', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('trm').value = TRM_DEFAULT; 
            calculateChannelCosts();
            calculatePackageCosts();
            calculateInsightsCosts();
            calculateAgentCosts();
            toggleAISection(); 
            calculateNotificationCosts(); 
            updateSummary();
            calculateCurrencyConversion();
            updateFavicon(0);
        });
    </script>
</body>
</html>
